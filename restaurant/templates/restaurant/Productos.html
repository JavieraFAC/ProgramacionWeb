{% extends 'restaurant/base.html' %}

{% block content %}

{% load static %}

<div class="container mt-5">
  <h2>Pedidos Anteriores</h2>
  {% if pedidos %}
      <div class="accordion" id="accordionPedidos">
          {% for pedido_info in pedidos %}
          {% with pedido=pedido_info.pedido total_pedido=pedido_info.total %}
          <div class="accordion-item">
              <h2 class="accordion-header" id="heading{{ pedido.id }}">
                  <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapse{{ pedido.id }}" aria-expanded="false" aria-controls="collapse{{ pedido.id }}">
                      Pedido #{{ pedido.id }} - {{ pedido.created_at }}
                  </button>
              </h2>
              <div id="collapse{{ pedido.id }}" class="accordion-collapse collapse" aria-labelledby="heading{{ pedido.id }}" data-bs-parent="#accordionPedidos">
                  <div class="accordion-body">
                      <div class="table-container">
                          <table class="table table-bordered">
                              <thead>
                                  <tr>
                                      <th>Producto</th>
                                      <th>Cantidad</th>
                                      <th>Precio</th>
                                  </tr>
                              </thead>
                              <tbody>
                                  {% for linea in pedido.lineapedido_set.all %}
                                  <tr>
                                      <td>{{ linea.producto.nombre }}</td>
                                      <td>{{ linea.cantidad }}</td>
                                      <td>${{ linea.producto.precio }}</td>
                                  </tr>
                                  {% endfor %}
                              </tbody>
                          </table>
                      </div>
                      <!-- Mostrar el total del pedido -->
                      <p><strong>Total del Pedido: </strong>${{ total_pedido }}</p>
                  </div>
              </div>
          </div>
          {% endwith %}
          {% endfor %}
      </div>
  {% else %}
      <p>No tienes pedidos anteriores.</p>
  {% endif %}
</div>

<style>
    .accordion-button:focus {
        outline: none;
    }
    .accordion-item {
        margin-bottom: 10px;
    }
    /* Estilos para permitir el scroll en el contenedor de la tabla */
    .table-container {
        max-height: 300px; /* ajusta esta altura seg√∫n tus necesidades */
        overflow-y: auto;
    }
</style>
{% endblock %}


